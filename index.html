<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Monetag Demo ‚Äî TG Mini App</title>

  <!-- ‚úÖ Monetag SDK -->
  <script src="//libtl.com/sdk.js" data-zone="10077226" data-sdk="show_10077226"></script>

  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#06b6d4; --muted:#9aa4b2; --glass: rgba(255,255,255,0.04);
      --radius:14px;
    }
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#071026);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .wrap{width:100%;max-width:960px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:18px;padding:26px;box-shadow:0 10px 40px rgba(2,6,23,0.6);}
    header{display:flex;gap:18px;align-items:center;margin-bottom:18px}
    .logo{
      width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#8b5cf6);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:#022; font-size:20px;box-shadow:0 6px 18px rgba(6,182,212,0.12);
    }
    h1{margin:0;font-size:22px}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .grid{display:grid;grid-template-columns: 1fr 320px; gap:18px;margin-top:18px}
    @media (max-width:820px){ .grid{grid-template-columns:1fr} }
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:inset 0 1px 0 rgba(255,255,255,0.02)}
    .status{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .dot{width:12px;height:12px;border-radius:50%}
    .dot.ok{background:#16a34a}
    .dot.warn{background:#f59e0b}
    .dot.err{background:#ef4444}
    .big{font-size:28px;margin:8px 0}
    .muted{color:var(--muted);font-size:13px}
    button{
      background:linear-gradient(90deg,var(--accent),#8b5cf6);
      color:#022;border:0;padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer;box-shadow:0 8px 30px rgba(11,20,38,0.45);
    }
    .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .row{display:flex;gap:12px;align-items:center}
    .meta{display:flex;flex-direction:column;gap:6px}
    .small-box{background:var(--glass);padding:10px;border-radius:10px;font-size:13px;color:var(--muted)}
    footer{margin-top:16px;text-align:right;color:var(--muted);font-size:12px}
    .log{height:160px;overflow:auto;background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;font-family:monospace;font-size:12px;color:#cfefff}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">TG</div>
      <div>
        <h1>Monetag / TG Demo Mini App</h1>
        <p class="lead">Auto In-App interstitial + button-triggered Rewarded ad + per-day counts</p>
      </div>
    </header>

    <div class="grid">
      <!-- LEFT -->
      <section class="card">
        <div class="status">
          <div id="sdkDot" class="dot warn"></div>
          <div>
            <div id="sdkStatus" style="font-weight:700">SDK: Checking‚Ä¶</div>
            <div class="muted" id="sdkDesc">Waiting for SDK to load</div>
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button id="runAdBtn">Run Rewarded Ad</button>
          <button id="simulateBtn" class="btn-ghost">Simulate</button>
          <button id="clearBtn" class="btn-ghost">Reset Counts</button>
        </div>

        <div style="margin-top:16px" class="row">
          <div class="meta">
            <div class="small-box">Today's ads: <span id="todayCount" style="font-weight:700">0</span></div>
            <div class="small-box">Yesterday: <span id="yesterdayCount">0</span></div>
          </div>
        </div>

        <div style="margin-top:14px">
          <label class="muted">Log</label>
          <div id="log" class="log" aria-live="polite"></div>
        </div>
      </section>

      <!-- RIGHT -->
      <aside class="card">
        <div class="big">In-App Interstitial</div>
        <p class="muted">Auto‚Äìshows when page loads using SDK configuration.</p>
        <hr style="border:none;border-top:1px solid rgba(255,255,255,0.05);margin:12px 0" />
        <div class="muted" style="font-size:13px">Rewarded ads can be triggered by user clicking the ‚ÄúRun Rewarded Ad‚Äù button. Once ad completes, a reward alert is shown.</div>
        <footer>¬© 2025 TG Demo ‚Äî Monetag SDK v1 Test</footer>
      </aside>
    </div>
  </div>

  <!-- ‚úÖ Monetag Logic -->
  <script>
    (function(){
      const STORAGE_KEY = 'monetag_demo_counts';
      const el = id => document.getElementById(id);
      const log = (msg)=>{
        const t = new Date().toLocaleTimeString();
        el('log').insertAdjacentHTML('afterbegin', `<div><b>[${t}]</b> ${msg}</div>`);
      };

      const todayKey = ()=> new Date().toISOString().slice(0,10);
      const yKey = ()=> {const d=new Date();d.setDate(d.getDate()-1);return d.toISOString().slice(0,10);}
      const read = ()=>JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}");
      const write = obj=>localStorage.setItem(STORAGE_KEY,JSON.stringify(obj));
      const incToday = ()=>{
        const c=read();const k=todayKey();
        c[k]=(c[k]||0)+1;write(c);updateUI();
      };
      const updateUI = ()=>{
        const c=read();el('todayCount').textContent=c[todayKey()]||0;
        el('yesterdayCount').textContent=c[yKey()]||0;
      };
      const reset=()=>{localStorage.removeItem(STORAGE_KEY);updateUI();log('Counts reset');};

      // Check SDK
      function checkSDK(){
        if(typeof show_10077226 === 'function'){
          el('sdkDot').className='dot ok';
          el('sdkStatus').textContent='SDK: Loaded';
          el('sdkDesc').textContent='libtl.com SDK active';
          log('SDK detected: show_10077226() available');
          return true;
        } else {
          el('sdkDot').className='dot err';
          el('sdkStatus').textContent='SDK: Not Loaded';
          el('sdkDesc').textContent='Check SDK script';
          log('SDK not found on window');
          return false;
        }
      }

      // Rewarded Ad run
      async function runRewarded(){
        if(typeof show_10077226!=='function'){ log('SDK missing'); return; }
        try{
          el('runAdBtn').disabled=true;
          el('runAdBtn').textContent='Showing‚Ä¶';
          log('Running Rewarded Interstitial‚Ä¶');
          await show_10077226();
          incToday();
          log('User completed ad ‚Äî rewarded!');
          alert('üéâ You have seen an ad and earned a reward!');
        }catch(e){
          log('Ad error: '+e.message);
        }finally{
          el('runAdBtn').disabled=false;
          el('runAdBtn').textContent='Run Rewarded Ad';
        }
      }

      // Auto In-App Interstitial show
      function autoInApp(){
        if(typeof show_10077226==='function'){
          log('Auto In-App interstitial init');
          show_10077226({
            type:'inApp',
            inAppSettings:{
              frequency:2,
              capping:0.1,
              interval:30,
              timeout:5,
              everyPage:false
            }
          });
        } else {
          log('In-App auto show skipped (SDK not ready)');
        }
      }

      // Events
      document.addEventListener('DOMContentLoaded',()=>{
        updateUI();
        checkSDK();
        setTimeout(()=>{ if(checkSDK()) autoInApp(); },800);

        el('runAdBtn').addEventListener('click', runRewarded);
        el('simulateBtn').addEventListener('click', ()=>{ incToday(); log('Simulated ad run'); });
        el('clearBtn').addEventListener('click', reset);

        log('Demo ready. Auto In-App ad will show soon.');
      });
    })();
  </script>
</body>
</html>
